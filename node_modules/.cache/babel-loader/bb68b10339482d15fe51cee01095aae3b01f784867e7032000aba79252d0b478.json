{"ast":null,"code":"/**\n * This file is a wrapper of msgpack.js.\n * The wrapper was written in order to ensure correct encoding of Algorand Transaction and other formats.\n * In particular, it matches go-algorand blockchain client, written in go (https://www.github.com/algorand/go-algorand.\n * Algorand's msgpack encoding follows to following rules -\n *  1. Every integer must be encoded to the smallest type possible (0-255-\\>8bit, 256-65535-\\>16bit, etx)\n *  2. All fields names must be sorted\n *  3. All empty and 0 fields should be omitted\n *  4. Every positive number must be encoded as uint\n *  5. Binary blob should be used for binary data and string for strings\n *  */\nimport * as msgpack from 'algo-msgpack-with-bigint';\n// Errors\nexport const ERROR_CONTAINS_EMPTY_STRING = 'The object contains empty or 0 values. First empty or 0 value encountered during encoding: ';\n/**\n * containsEmpty returns true if any of the object's values are empty, false otherwise.\n * Empty arrays considered empty\n * @param obj - The object to check\n * @returns \\{true, empty key\\} if contains empty, \\{false, undefined\\} otherwise\n */\nfunction containsEmpty(obj) {\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (!obj[key] || obj[key].length === 0) {\n        return {\n          containsEmpty: true,\n          firstEmptyKey: key\n        };\n      }\n    }\n  }\n  return {\n    containsEmpty: false,\n    firstEmptyKey: undefined\n  };\n}\n/**\n * rawEncode encodes objects using msgpack, regardless of whether there are\n * empty or 0 value fields.\n * @param obj - a dictionary to be encoded. May or may not contain empty or 0 values.\n * @returns msgpack representation of the object\n */\nexport function rawEncode(obj) {\n  // enable the canonical option\n  const options = {\n    sortKeys: true\n  };\n  return msgpack.encode(obj, options);\n}\n/**\n * encode encodes objects using msgpack\n * @param obj - a dictionary to be encoded. Must not contain empty or 0 values.\n * @returns msgpack representation of the object\n * @throws Error containing ERROR_CONTAINS_EMPTY_STRING if the object contains empty or zero values\n */\nexport function encode(obj) {\n  // Check for empty values\n  const emptyCheck = containsEmpty(obj);\n  if (emptyCheck.containsEmpty) {\n    throw new Error(ERROR_CONTAINS_EMPTY_STRING + emptyCheck.firstEmptyKey);\n  }\n  // enable the canonical option\n  return rawEncode(obj);\n}\nexport function decode(buffer) {\n  return msgpack.decode(buffer);\n}","map":{"version":3,"names":["msgpack","ERROR_CONTAINS_EMPTY_STRING","containsEmpty","obj","key","Object","prototype","hasOwnProperty","call","length","firstEmptyKey","undefined","rawEncode","options","sortKeys","encode","emptyCheck","Error","decode","buffer"],"sources":["/Users/wanjinwoo/Desktop/Study/web3/Algorand/Athena3-Hub/node_modules/algosdk/src/encoding/encoding.ts"],"sourcesContent":["/**\n * This file is a wrapper of msgpack.js.\n * The wrapper was written in order to ensure correct encoding of Algorand Transaction and other formats.\n * In particular, it matches go-algorand blockchain client, written in go (https://www.github.com/algorand/go-algorand.\n * Algorand's msgpack encoding follows to following rules -\n *  1. Every integer must be encoded to the smallest type possible (0-255-\\>8bit, 256-65535-\\>16bit, etx)\n *  2. All fields names must be sorted\n *  3. All empty and 0 fields should be omitted\n *  4. Every positive number must be encoded as uint\n *  5. Binary blob should be used for binary data and string for strings\n *  */\n\nimport * as msgpack from 'algo-msgpack-with-bigint';\n\n// Errors\nexport const ERROR_CONTAINS_EMPTY_STRING =\n  'The object contains empty or 0 values. First empty or 0 value encountered during encoding: ';\n\n/**\n * containsEmpty returns true if any of the object's values are empty, false otherwise.\n * Empty arrays considered empty\n * @param obj - The object to check\n * @returns \\{true, empty key\\} if contains empty, \\{false, undefined\\} otherwise\n */\nfunction containsEmpty(obj: Record<string | number | symbol, any>) {\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (!obj[key] || obj[key].length === 0) {\n        return { containsEmpty: true, firstEmptyKey: key };\n      }\n    }\n  }\n  return { containsEmpty: false, firstEmptyKey: undefined };\n}\n\n/**\n * rawEncode encodes objects using msgpack, regardless of whether there are\n * empty or 0 value fields.\n * @param obj - a dictionary to be encoded. May or may not contain empty or 0 values.\n * @returns msgpack representation of the object\n */\nexport function rawEncode(obj: Record<string | number | symbol, any>) {\n  // enable the canonical option\n  const options = { sortKeys: true };\n  return msgpack.encode(obj, options);\n}\n\n/**\n * encode encodes objects using msgpack\n * @param obj - a dictionary to be encoded. Must not contain empty or 0 values.\n * @returns msgpack representation of the object\n * @throws Error containing ERROR_CONTAINS_EMPTY_STRING if the object contains empty or zero values\n */\nexport function encode(obj: Record<string | number | symbol, any>) {\n  // Check for empty values\n  const emptyCheck = containsEmpty(obj);\n  if (emptyCheck.containsEmpty) {\n    throw new Error(ERROR_CONTAINS_EMPTY_STRING + emptyCheck.firstEmptyKey);\n  }\n\n  // enable the canonical option\n  return rawEncode(obj);\n}\n\nexport function decode(buffer: ArrayLike<number>) {\n  return msgpack.decode(buffer);\n}\n"],"mappings":"AAAA;;;;;;;;;;;AAYA,OAAO,KAAKA,OAAO,MAAM,0BAA0B;AAEnD;AACA,OAAO,MAAMC,2BAA2B,GACtC,6FAA6F;AAE/F;;;;;;AAMA,SAASC,aAAaA,CAACC,GAA0C;EAC/D,KAAK,MAAMC,GAAG,IAAID,GAAG,EAAE;IACrB,IAAIE,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACL,GAAG,EAAEC,GAAG,CAAC,EAAE;MAClD,IAAI,CAACD,GAAG,CAACC,GAAG,CAAC,IAAID,GAAG,CAACC,GAAG,CAAC,CAACK,MAAM,KAAK,CAAC,EAAE;QACtC,OAAO;UAAEP,aAAa,EAAE,IAAI;UAAEQ,aAAa,EAAEN;QAAG,CAAE;;;;EAIxD,OAAO;IAAEF,aAAa,EAAE,KAAK;IAAEQ,aAAa,EAAEC;EAAS,CAAE;AAC3D;AAEA;;;;;;AAMA,OAAM,SAAUC,SAASA,CAACT,GAA0C;EAClE;EACA,MAAMU,OAAO,GAAG;IAAEC,QAAQ,EAAE;EAAI,CAAE;EAClC,OAAOd,OAAO,CAACe,MAAM,CAACZ,GAAG,EAAEU,OAAO,CAAC;AACrC;AAEA;;;;;;AAMA,OAAM,SAAUE,MAAMA,CAACZ,GAA0C;EAC/D;EACA,MAAMa,UAAU,GAAGd,aAAa,CAACC,GAAG,CAAC;EACrC,IAAIa,UAAU,CAACd,aAAa,EAAE;IAC5B,MAAM,IAAIe,KAAK,CAAChB,2BAA2B,GAAGe,UAAU,CAACN,aAAa,CAAC;;EAGzE;EACA,OAAOE,SAAS,CAACT,GAAG,CAAC;AACvB;AAEA,OAAM,SAAUe,MAAMA,CAACC,MAAyB;EAC9C,OAAOnB,OAAO,CAACkB,MAAM,CAACC,MAAM,CAAC;AAC/B"},"metadata":{},"sourceType":"module","externalDependencies":[]}