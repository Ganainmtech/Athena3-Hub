{"ast":null,"code":"import _regeneratorRuntime from \"/Users/wanjinwoo/Desktop/Study/web3/Algorand/Athena3-Hub/Athena3-Hub-athena-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/wanjinwoo/Desktop/Study/web3/Algorand/Athena3-Hub/Athena3-Hub-athena-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as crypto from \"@walletconnect/crypto\";\nimport * as encoding from \"@walletconnect/encoding\";\nimport { convertArrayBufferToBuffer, convertBufferToArrayBuffer } from \"@walletconnect/utils\";\nexport function generateKey(_x) {\n  return _generateKey.apply(this, arguments);\n}\nfunction _generateKey() {\n  _generateKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(length) {\n    var _length, bytes, result;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _length = (length || 256) / 8;\n          bytes = crypto.randomBytes(_length);\n          result = convertBufferToArrayBuffer(encoding.arrayToBuffer(bytes));\n          return _context.abrupt(\"return\", result);\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _generateKey.apply(this, arguments);\n}\nexport function verifyHmac(_x2, _x3) {\n  return _verifyHmac.apply(this, arguments);\n}\nfunction _verifyHmac() {\n  _verifyHmac = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(payload, key) {\n    var cipherText, iv, hmac, hmacHex, unsigned, chmac, chmacHex;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          cipherText = encoding.hexToArray(payload.data);\n          iv = encoding.hexToArray(payload.iv);\n          hmac = encoding.hexToArray(payload.hmac);\n          hmacHex = encoding.arrayToHex(hmac, false);\n          unsigned = encoding.concatArrays(cipherText, iv);\n          _context2.next = 7;\n          return crypto.hmacSha256Sign(key, unsigned);\n        case 7:\n          chmac = _context2.sent;\n          chmacHex = encoding.arrayToHex(chmac, false);\n          if (!(encoding.removeHexPrefix(hmacHex) === encoding.removeHexPrefix(chmacHex))) {\n            _context2.next = 11;\n            break;\n          }\n          return _context2.abrupt(\"return\", true);\n        case 11:\n          return _context2.abrupt(\"return\", false);\n        case 12:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _verifyHmac.apply(this, arguments);\n}\nexport function encrypt(_x4, _x5, _x6) {\n  return _encrypt.apply(this, arguments);\n}\nfunction _encrypt() {\n  _encrypt = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data, key, providedIv) {\n    var _key, ivArrayBuffer, iv, ivHex, contentString, content, cipherText, cipherTextHex, unsigned, hmac, hmacHex;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _key = encoding.bufferToArray(convertArrayBufferToBuffer(key));\n          _context3.t0 = providedIv;\n          if (_context3.t0) {\n            _context3.next = 6;\n            break;\n          }\n          _context3.next = 5;\n          return generateKey(128);\n        case 5:\n          _context3.t0 = _context3.sent;\n        case 6:\n          ivArrayBuffer = _context3.t0;\n          iv = encoding.bufferToArray(convertArrayBufferToBuffer(ivArrayBuffer));\n          ivHex = encoding.arrayToHex(iv, false);\n          contentString = JSON.stringify(data);\n          content = encoding.utf8ToArray(contentString);\n          _context3.next = 13;\n          return crypto.aesCbcEncrypt(iv, _key, content);\n        case 13:\n          cipherText = _context3.sent;\n          cipherTextHex = encoding.arrayToHex(cipherText, false);\n          unsigned = encoding.concatArrays(cipherText, iv);\n          _context3.next = 18;\n          return crypto.hmacSha256Sign(_key, unsigned);\n        case 18:\n          hmac = _context3.sent;\n          hmacHex = encoding.arrayToHex(hmac, false);\n          return _context3.abrupt(\"return\", {\n            data: cipherTextHex,\n            hmac: hmacHex,\n            iv: ivHex\n          });\n        case 21:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return _encrypt.apply(this, arguments);\n}\nexport function decrypt(_x7, _x8) {\n  return _decrypt.apply(this, arguments);\n}\nfunction _decrypt() {\n  _decrypt = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(payload, key) {\n    var _key, verified, cipherText, iv, buffer, utf8, data;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          _key = encoding.bufferToArray(convertArrayBufferToBuffer(key));\n          if (_key) {\n            _context4.next = 3;\n            break;\n          }\n          throw new Error(\"Missing key: required for decryption\");\n        case 3:\n          _context4.next = 5;\n          return verifyHmac(payload, _key);\n        case 5:\n          verified = _context4.sent;\n          if (verified) {\n            _context4.next = 8;\n            break;\n          }\n          return _context4.abrupt(\"return\", null);\n        case 8:\n          cipherText = encoding.hexToArray(payload.data);\n          iv = encoding.hexToArray(payload.iv);\n          _context4.next = 12;\n          return crypto.aesCbcDecrypt(iv, _key, cipherText);\n        case 12:\n          buffer = _context4.sent;\n          utf8 = encoding.arrayToUtf8(buffer);\n          _context4.prev = 14;\n          data = JSON.parse(utf8);\n          _context4.next = 21;\n          break;\n        case 18:\n          _context4.prev = 18;\n          _context4.t0 = _context4[\"catch\"](14);\n          return _context4.abrupt(\"return\", null);\n        case 21:\n          return _context4.abrupt(\"return\", data);\n        case 22:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4, null, [[14, 18]]);\n  }));\n  return _decrypt.apply(this, arguments);\n}","map":{"version":3,"names":["crypto","encoding","convertArrayBufferToBuffer","convertBufferToArrayBuffer","generateKey","_x","_generateKey","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","length","_length","bytes","result","wrap","_callee$","_context","prev","next","randomBytes","arrayToBuffer","abrupt","stop","verifyHmac","_x2","_x3","_verifyHmac","_callee2","payload","key","cipherText","iv","hmac","hmacHex","unsigned","chmac","chmacHex","_callee2$","_context2","hexToArray","data","arrayToHex","concatArrays","hmacSha256Sign","sent","removeHexPrefix","encrypt","_x4","_x5","_x6","_encrypt","_callee3","providedIv","_key","ivArrayBuffer","ivHex","contentString","content","cipherTextHex","_callee3$","_context3","bufferToArray","t0","JSON","stringify","utf8ToArray","aesCbcEncrypt","decrypt","_x7","_x8","_decrypt","_callee4","verified","buffer","utf8","_callee4$","_context4","Error","aesCbcDecrypt","arrayToUtf8","parse"],"sources":["../../src/index.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}